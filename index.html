<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Trigger Racer</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <!-- Bright sky -->
      <a-sky color="#88ccff"></a-sky>

      <!-- Ground -->
      <a-plane rotation="-90 0 0" width="100" height="100" color="#eee"></a-plane>

      <!-- Camera rig -->
      <a-entity id="rig" position="0 1.6 0">
        <a-entity camera look-controls position="0 0 0"></a-entity>
        <a-entity oculus-touch-controls="hand: right"></a-entity>
      </a-entity>

      <!-- Car entity -->
      <a-entity id="car" position="0 0 0" car-controller></a-entity>

      <script>
        AFRAME.registerComponent('car-controller', {
          init: function () {
            this.speed = 4;
            this.direction = new THREE.Vector3(0, 0, -1);
            this.moving = false;

            // Listen for trigger press
            const rig = document.querySelector('#rig');
            rig.addEventListener('triggerdown', () => {
              this.moving = true;
            });
            rig.addEventListener('triggerup', () => {
              this.moving = false;
            });
          },
          tick: function (time, deltaTime) {
            if (!this.moving) return;

            const dt = deltaTime / 1000;
            const move = this.direction.clone().multiplyScalar(this.speed * dt);
            this.el.object3D.position.add(move);

            // Sync camera rig to car position
            const rig = document.querySelector('#rig');
            rig.object3D.position.copy(this.el.object3D.position);
          }
        });
      </script>
    </a-scene>
  </body>
</html>

